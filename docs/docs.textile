h1. Longtail Video Player com plugin de hipervideo

<hr />

Este documento descreve o procedimento necessário para o uso e configuração do <a href="http://longtailvideo.com/">Longtail Video Player</a> acrescido do plugin de hipervideo. 

h2. Adicionado o player a uma página

Para adicionar o player do Longtail Video, acrescido dos plugins para hipervideo, é necessário colar na página o código do arquivo <tt><a href="embed.html">embed.html</a></tt>, presente no mesmo diretório deste documento.

Além disto, os arquivos <tt>player-viral.swf</tt>, <tt>swfobject.js</tt>, <tt>hipervideo.swf</tt> e <tt>statemanager.swf</tt> devem estar presentes no subdiretório <tt>./support</tt>, relativo ao caminho do diretório que contém o arquivo <tt>html</tt> a ser  alterado. Este diretório pode ser alterado se o código em <tt>embed.html</tt> for alterado coerentemente, nas linhas comentadas com:
* <tt>// PLAYER PATH HERE</tt>
* <tt>// SWFOBJECT.JS PATH HERE</tt>

Os dois primeiros arquivos podem ser encontrados <a href="./">aqui</a>. Os demais compõem o plugin de hipervideo e precisam ser compilados separadamente.

h2. Compilação do plugin

Para compilar o plugin de hipervideo, o SDK do Flex será necessário. Este pode ser obtido gratuitamente na página de <a href="http://www.adobe.com/products/flex/flexdownloads/">downloads</a> da Adobe.

Depois, o arquivo <tt>build.sh.example</tt> que acompanha esta distribuição, fica no diretório <tt>src/</tt> e deve ser copiado para um novo arquivo <tt>build.sh</tt>. Este, por sua vez, deve ser alterado, definindo o valor da variável <tt>FLEXPATH</tt> como a localização da instalação local SDK do Flex.

Por fim, basta executar o script <tt>build.sh</tt> para compilar o plugin, que será criado no diretório <tt>/bin-debug/plugins/hipervideo/</tt>.

h2. Variáveis do Longtail Video Player

No código do <tt>embed.html</tt> são definidas algumas variáveis do player, incluindo a localização do arquivo de vídeo a ser reproduzido. Esta configuração é determinada pela variável <tt>file</tt>, definida na linha comentada com:
* <tt>// VIDEO FILENAME HERE</tt>

Da mesma forma, a imagem de preview, exibida antes do início do vídeo, é determinada pela variável <tt>image</tt>, definida na linha comentada com:
* <tt>// VIDEO PREVIEW IMAGE HERE</tt>

Mais informações sobre as variáveis do Longtail Video Player podem ser obtidas no <a href="http://developer.longtailvideo.com/trac/wiki/FlashVars">site do produto</a>.

h2. Variáveis do plugin de hipervideo

Os dados de hipervideo são fornecidos por um arquivo XML que também deve ser informado como uma variável do player: <tt>hipervideo.file</tt>. Esta é definida na linha comentada com:
* <tt>// HIPERVIDEO DATA FILE HERE</tt>

Os links http podem ser abertos na janela em que o player está ou em uma nova janela. Este comportamento é determinado pela variável <tt>hipervideo.target</tt>, definida na linha comentada com:
* <tt>// LINK TARGET HERE</tt>

Os valores possíveis são:

|<tt>_self</tt>|Abre na mesma janela|
|<tt>_blank</tt>|Abre em uma nova janela|

O posicionamento das barras de vídeos relacionados e de links é determinado pela variável <tt>hipervideo.barposition</tt>, definida na linha comentada com:
* <tt>// BAR POSITION</tt>
	
Os valores possíveis são:

|<tt>bottom</tt>|Parte inferior da janela de exibição do vídeo|
|<tt>center</tt>|Parte central da janela de exibição do vídeo|
|<tt>top</tt>|Parte superior da janela de exibição do vídeo|

h2. Formato do XML

Os itens exibidos durante a execução do vídeo são descritos em um arquivo xml, determinado pela variável <tt>hipervideo.file</tt>. As tags mais elementares, que serão combinadas de forma a compor estes itens, são:

h3. Pause

Indica uma interrupção na execução do vídeo.

<pre>
<pause at="hh:mm:ss" />
</pre>

O formato de tempo hh:mm:ss indica Horas:Minutos:Segundos, contados a partir do início do vídeo.

Opcionalmente, podemos usar um valor não inteiro para os segundos (por exemplo, 01:12:20.5).

h3. Link

Indica uma ação a ser executada.

<pre>
<link [activity_id="parametro"]>
	<tooltip>Tooltip do link</tooltip>
	<url>http://url.para.um.site</url> || <time>hh:mm:ss</time>
	<thumbnail>thumbnail.representando.link.jpg</thumbnail>
</link>
</pre>

As tags <tt>url</tt> e <tt>time</tt> são mutuamente exclusivas. A primeira indica a abertura de uma referência externa e a segunda indica um salto para um momento do vídeo.

h3. Time

Indica um intervalo de tempo.

<pre>
<time start="início" duration="fim"/>
</pre>

Os valores de início e fim da exibição do elemento devem ser escritos em formato hh:mm:ss.

h3. Position

Indica uma posição na janela de exibição do vídeo.

<pre>
<position x="X" y="Y" height="altura" width="largura"/>
</pre>

Os valores de X e Y indicam respectivamente as coordenadas horizontal e vertical do canto superior esquerdo do item. Todos os valores são entendidos em pixels.

h3. Text Content

Indica um conteúdo textual.

<pre>
<textContent>
	<![CDATA[Um texto podendo usar <b>negrito</b>, <i>itálico</i> e <u>sublinhado</u>]]>
</textContent>
</pre>

Apenas negrito, itálico e sublinhado são suportados como formatação.

h3. Image Content

Indica uma imagem como conteúdo.

<pre>
	<imageContent>imagem.gif</imageContent>
</pre>

h3. Element

Indica um elemento de hipervideo.

<pre>
<element>
	<textContent> || <imageContent>
	<link>
	<time>
	<position>
</element>
</pre>

As tags <tt>textContent</tt> e <tt>imageContent</tt> são mutualmente exclusivas.

h3. Playlist

Indica uma coleção de vídeos relacionados.

<pre>
<playlist>
	<link>
	<link>
	...
	<link>
</playlist>
</pre>

h3. Actions

Indica as ações a serem realizadas durante a execução do vídeo

<pre>
<actions>
	<pause>
	<pause>
	...
	<pause>
</actions>
</pre>

h3. Elements

Indica uma coleção de elementos a serem exibidos durante a execução do vídeo.

<pre>
<elements>
	<element>
	<element>
	...
	<element>
</elements>
</pre>

h3. Video

Indica a raiz do arquivo xml.

<pre>
<video>
	<playlist>
	<actions>
	<elements>
</video>
</pre>

h2. Exemplo do XML

Pequeno exemplo do arquivo XML.

<pre>
<video>
	<!-- vídeos relacionados -->
	<playlist>
		<link>
			<tooltip>Tooltip para barra de links relacionados</tooltip>
			<url>http://url_para_algo.com.br</url>
			<thumbnail>thumbnail_do_link.jpg</thumbnail>
		</link>	
		...
	</playlist>

	<!-- ações realizadas automaticamente pelo player -->
	<actions>
		<!-- pausar automaticamente a execução do vídeo no instante hh:mm:ss -->
		<pause at="hh:mm:ss" />
		...
	</actions>
	
	<!-- elementos exibidos durante a exibição do vídeo -->
	<elements>
		<!-- elementos de texto -->
		<element>
			<textContent>
				<![CDATA[Um texto podendo usar <b>negrito</b>, <i>itálico</i> e <u>sublinhado</u>]]>
			</textContent>
			<link>
				<tooltip>Tooltip para barra de links do vídeo</tooltip>
				<url>http://url_para_algo.com.br</url>
				<thumbnail>thumbnail_do_link.jpg</thumbnail>
			</link>
			<!-- os valores de início e fim da exibição do elemento, em formato hh:mm:ss -->
			<time start="início" duration="fim"/>
			<!-- valores para x, y, height e width em pixels -->	
			<position x="X" y="Y" height="altura" width="largura"/>
		</element>
		<!-- elementos de imagem -->
		<element>
			<imageContent>imagem.gif</imageContent>
			<!-- quando clicado irá executar a função logActivity com o argumento parametro_do_log -->
			<link activity_id="parametro_do_log">
				<tooltip>Tooltip para barra de links do vídeo</tooltip>
				<!-- quando clicado irá para a posição hh:mm:ss do vídeo -->
				<time>hh:mm:ss</time>
				<thumbnail>thumbnail_do_link.jpg</thumbnail>
			</link>
			<time start="início" duration="fim"/>
			<position x="X" y="Y" height="altura" width="largura"/>
		</element>
		...
	</elements>
</video>
</pre>

Um exemplo concreto <a href="../html-template/support/links.xml">também está disponível</a>.
